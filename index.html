<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKOPI - Sistem Kinerja Operasi dan Pemeliharaan Irigasi</title>
    
    <!-- External CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .container {
            display: flex;
            min-height: calc(100vh - 100px);
        }

        .sidebar {
            width: 250px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            padding: 1rem 0;
        }

        .menu-item {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-item:hover {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
        }

        .menu-item.active {
            background-color: #3498db;
            color: white;
            border-left: 4px solid #2980b9;
        }

        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h4 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            opacity: 0.9;
        }

        /* Leaflet Map Styles */
        #map {
            height: 500px;
            width: 100%;
            border-radius: 10px;
            margin: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .map-controls {
            margin: 1rem 0;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .map-control-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .map-control-btn:hover {
            background: #2980b9;
        }

        .map-control-btn.active {
            background: #27ae60;
        }

        .map-legend {
            background: white;
            padding: 1rem;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-top: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin-right: 0.5rem;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .status-hadir {
            background-color: #27ae60;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .status-tidak-hadir {
            background-color: #e74c3c;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .status-izin {
            background-color: #f39c12;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .progress-bar {
            background-color: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            height: 20px;
            margin: 0.5rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            transition: width 0.3s ease;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 1rem 0;
        }

        .irrigation-schema {
            text-align: center;
            padding: 2rem;
        }

        .schema-diagram {
            max-width: 100%;
            height: auto;
            border: 2px solid #3498db;
            border-radius: 10px;
            background: #f8f9fa;
            padding: 2rem;
            margin: 1rem 0;
        }

        .schema-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .schema-box {
            background: #3498db;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            min-width: 120px;
        }

        .schema-arrow {
            font-size: 2rem;
            color: #3498db;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.2rem;
            color: #3498db;
        }

        .loading-spinner::before {
            content: '';
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom Leaflet Popup Styles */
        .custom-popup {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .custom-popup h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .custom-popup p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
            }
            
            .content {
                order: 1;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }

            #map {
                height: 300px;
            }

            .map-controls {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-tint"></i> SKOPI</h1>
        <p>Sistem Kinerja Operasi dan Pemeliharaan Irigasi - DI. Molek</p>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="menu-item active" data-section="dashboard">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </div>
            <div class="menu-item" data-section="profil">
                <i class="fas fa-info-circle"></i> Profil Jaringan Irigasi
            </div>
            <div class="menu-item" data-section="peta">
                <i class="fas fa-map"></i> Peta Layout
            </div>
            <div class="menu-item" data-section="skema">
                <i class="fas fa-project-diagram"></i> Skema Irigasi
            </div>
            <div class="menu-item" data-section="tenaga">
                <i class="fas fa-users"></i> Tenaga dan Absensi
            </div>
            <div class="menu-item" data-section="progres">
                <i class="fas fa-chart-line"></i> Bobot Progres Harian
            </div>
            <div class="menu-item" data-section="kurva">
                <i class="fas fa-chart-area"></i> Kurva S Kinerja Bulanan
            </div>
        </div>

        <div class="content">
            <!-- Dashboard Section -->
            <div id="dashboard" class="content-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>15</h4>
                        <p>Total Petugas</p>
                    </div>
                    <div class="stat-card">
                        <h4>85%</h4>
                        <p>Tingkat Kehadiran</p>
                    </div>
                    <div class="stat-card">
                        <h4>1,250</h4>
                        <p>Luas Layanan (Ha)</p>
                    </div>
                    <div class="stat-card">
                        <h4>92%</h4>
                        <p>Kinerja Bulanan</p>
                    </div>
                </div>

                <div class="card">
                    <h3>Ringkasan Sistem</h3>
                    <p>Selamat datang di SKOPI (Sistem Kinerja Operasi dan Pemeliharaan Irigasi) DI. Molek. 
                    Sistem ini membantu dalam monitoring dan evaluasi kinerja operasional jaringan irigasi.</p>
                    
                    <div style="margin-top: 2rem;">
                        <h4>Status Operasional Hari Ini:</h4>
                        <ul style="margin-top: 1rem; padding-left: 2rem;">
                            <li>✅ Pintu Air Utama: Normal</li>
                            <li>✅ Saluran Primer: Berfungsi Baik</li>
                            <li>⚠️ Saluran Sekunder Blok C: Perlu Pembersihan</li>
                            <li>✅ Bangunan Bagi: Normal</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Profil Jaringan Irigasi Section -->
            <div id="profil" class="content-section">
                <div class="card">
                    <h3>Profil DI. Molek</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <div>
                            <h4>Informasi Umum</h4>
                            <table>
                                <tr><td><strong>Nama Daerah Irigasi</strong></td><td>DI. Molek</td></tr>
                                <tr><td><strong>Lokasi</strong></td><td>Kabupaten Malang, Jawa Timur</td></tr>
                                <tr><td><strong>Luas Baku</strong></td><td>1,250 Ha</td></tr>
                                <tr><td><strong>Luas Fungsional</strong></td><td>1,180 Ha</td></tr>
                                <tr><td><strong>Jenis Irigasi</strong></td><td>Teknis</td></tr>
                                <tr><td><strong>Sumber Air</strong></td><td>Sungai Brantas</td></tr>
                            </table>
                        </div>
                        <div>
                            <h4>Infrastruktur</h4>
                            <table>
                                <tr><td><strong>Bendung Utama</strong></td><td>1 Unit</td></tr>
                                <tr><td><strong>Saluran
								                                <tr><td><strong>Saluran Primer</strong></td><td>8.5 Km</td></tr>
                                <tr><td><strong>Saluran Sekunder</strong></td><td>15.2 Km</td></tr>
                                <tr><td><strong>Saluran Tersier</strong></td><td>28.7 Km</td></tr>
                                <tr><td><strong>Bangunan Bagi</strong></td><td>12 Unit</td></tr>
                                <tr><td><strong>Bangunan Sadap</strong></td><td>45 Unit</td></tr>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Kondisi Jaringan</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Komponen</th>
                                    <th>Kondisi</th>
                                    <th>Persentase Baik</th>
                                    <th>Kebutuhan Pemeliharaan</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Bendung Utama</td>
                                    <td><span class="status-hadir">Baik</span></td>
                                    <td>95%</td>
                                    <td>Rutin</td>
                                </tr>
                                <tr>
                                    <td>Saluran Primer</td>
                                    <td><span class="status-hadir">Baik</span></td>
                                    <td>88%</td>
                                    <td>Pembersihan Berkala</td>
                                </tr>
                                <tr>
                                    <td>Saluran Sekunder</td>
                                    <td><span class="status-izin">Sedang</span></td>
                                    <td>75%</td>
                                    <td>Perbaikan Ringan</td>
                                </tr>
                                <tr>
                                    <td>Bangunan Bagi</td>
                                    <td><span class="status-hadir">Baik</span></td>
                                    <td>92%</td>
                                    <td>Rutin</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Peta Layout Section -->
            <div id="peta" class="content-section">
                <div class="card">
                    <h3>Peta Layout DI. Molek</h3>
                    
                    <!-- Map Controls -->
                    <div class="map-controls">
                        <button class="map-control-btn active" onclick="toggleLayer('all')">
                            <i class="fas fa-eye"></i> Tampilkan Semua
                        </button>
                        <button class="map-control-btn" onclick="toggleLayer('bendung')">
                            <i class="fas fa-water"></i> Bendung
                        </button>
                        <button class="map-control-btn" onclick="toggleLayer('saluran')">
                            <i class="fas fa-route"></i> Saluran
                        </button>
                        <button class="map-control-btn" onclick="toggleLayer('bangunan')">
                            <i class="fas fa-building"></i> Bangunan
                        </button>
                        <button class="map-control-btn" onclick="toggleLayer('sawah')">
                            <i class="fas fa-seedling"></i> Area Sawah
                        </button>
                    </div>

                    <!-- Leaflet Map Container -->
                    <div id="map"></div>

                    <!-- Map Legend -->
                    <div class="map-legend">
                        <h4>Legenda:</h4>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #2980b9;"></div>
                            <span>Bendung Utama</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #3498db;"></div>
                            <span>Saluran Primer</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #5dade2;"></div>
                            <span>Saluran Sekunder</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #85c1e9;"></div>
                            <span>Saluran Tersier</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #e74c3c;"></div>
                            <span>Bangunan Bagi</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #27ae60;"></div>
                            <span>Area Sawah</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Informasi Koordinat</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nama Lokasi</th>
                                    <th>Jenis</th>
                                    <th>Koordinat</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Bendung Molek</td>
                                    <td>Bendung Utama</td>
                                    <td>-7.9666, 112.6326</td>
                                    <td><span class="status-hadir">Aktif</span></td>
                                </tr>
                                <tr>
                                    <td>Bangunan Bagi 1</td>
                                    <td>Bangunan Bagi</td>
                                    <td>-7.9656, 112.6336</td>
                                    <td><span class="status-hadir">Aktif</span></td>
                                </tr>
                                <tr>
                                    <td>Bangunan Bagi 2</td>
                                    <td>Bangunan Bagi</td>
                                    <td>-7.9646, 112.6346</td>
                                    <td><span class="status-izin">Maintenance</span></td>
                                </tr>
                                <tr>
                                    <td>Pintu Air Sekunder A</td>
                                    <td>Pintu Air</td>
                                    <td>-7.9636, 112.6356</td>
                                    <td><span class="status-hadir">Aktif</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Skema Irigasi Section -->
            <div id="skema" class="content-section">
                <div class="card">
                    <h3>Skema Jaringan Irigasi DI. Molek</h3>
                    <div class="irrigation-schema">
                        <div class="schema-diagram">
                            <div class="schema-flow">
                                <div class="schema-box">
                                    <i class="fas fa-water"></i>
                                    <br>Sungai Brantas
                                </div>
                                <div class="schema-arrow">→</div>
                                <div class="schema-box">
                                    <i class="fas fa-dam"></i>
                                    <br>Bendung Molek
                                </div>
                                <div class="schema-arrow">→</div>
                                <div class="schema-box">
                                    <i class="fas fa-route"></i>
                                    <br>Saluran Primer
                                </div>
                            </div>
                            <div class="schema-arrow" style="transform: rotate(90deg); margin: 1rem 0;">↓</div>
                            <div class="schema-flow">
                                <div class="schema-box">
                                    <i class="fas fa-building"></i>
                                    <br>Bangunan Bagi 1
                                </div>
                                <div class="schema-arrow">→</div>
                                <div class="schema-box">
                                    <i class="fas fa-route"></i>
                                    <br>Saluran Sekunder
                                </div>
                                <div class="schema-arrow">→</div>
                                <div class="schema-box">
                                    <i class="fas fa-seedling"></i>
                                    <br>Area Sawah
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 2rem; text-align: left;">
                            <h4>Keterangan Skema:</h4>
                            <ul style="margin-top: 1rem; padding-left: 2rem;">
                                <li><strong>Intake:</strong> Air diambil dari Sungai Brantas melalui Bendung Molek</li>
                                <li><strong>Distribusi Primer:</strong> Air dialirkan melalui saluran primer sepanjang 8.5 km</li>
                                <li><strong>Pembagian:</strong> Air dibagi melalui 12 bangunan bagi ke saluran sekunder</li>
                                <li><strong>Distribusi Sekunder:</strong> Air dialirkan ke area sawah melalui saluran sekunder dan tersier</li>
                                <li><strong>Irigasi:</strong> Air sampai ke petakan sawah seluas 1,180 ha fungsional</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tenaga dan Absensi Section -->
            <div id="tenaga" class="content-section">
                <div class="card">
                    <h3>Data Tenaga Kerja</h3>
                    <div class="stats-grid">
                        <div class="stat-card" style="background: linear-gradient(135deg, #27ae60, #2ecc71);">
                            <h4>13</h4>
                            <p>Hadir Hari Ini</p>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            <h4>1</h4>
                            <p>Tidak Hadir</p>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #f39c12, #e67e22);">
                            <h4>1</h4>
                            <p>Izin</p>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                            <h4>85%</h4>
                            <p>Tingkat Kehadiran</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Absensi Harian</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Nama Petugas</th>
                                    <th>Jabatan</th>
                                    <th>Status Hari Ini</th>
                                    <th>Jam Masuk</th>
                                    <th>Lokasi Tugas</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Budi Santoso</td>
                                    <td>Kepala Ranting</td>
                                    <td><span class="status-hadir">Hadir</span></td>
                                    <td>07:30</td>
                                    <td>Bendung Molek</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Siti Aminah</td>
                                    <td>Juru Pengairan</td>
                                    <td><span class="status-hadir">Hadir</span></td>
                                    <td>07:45</td>
                                    <td>Saluran Primer</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Ahmad Wijaya</td>
                                    <td>Petugas Pintu Air</td>
                                    <td><span class="status-tidak-hadir">Tidak Hadir</span></td>
                                    <td>-</td>
                                    <td>Bangunan Bagi 1</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Dewi Sartika</td>
                                    <td>Juru Pengairan</td>
                                    <td><span class="status-izin">Izin</span></td>
                                    <td>-</td>
                                    <td>Saluran Sekunder A</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>Rudi Hartono</td>
                                    <td>Petugas Pemeliharaan</td>
                                    <td><span class="status-hadir">Hadir</span></td>
                                    <td>08:00</td>
                                    <td>Area Maintenance</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Bobot Progres Harian Section -->
            <div id="progres" class="content-section">
                <div class="card">
                    <h3>Bobot Progres Harian</h3>
                    <div class="chart-container">
                        <canvas id="progressChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h3>Detail Progres Kegiatan</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Kegiatan</th>
                                    <th>Target</th>
                                    <th>Realisasi</th>
                                    <th>Progres</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Pembersihan Saluran Primer</td>
                                    <td>8.5 Km</td>
                                    <td>7.2 Km</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 85%;"></div>
                                                                                </div>
                                        85%
                                    </td>
                                    <td><span class="status-hadir">On Track</span></td>
                                </tr>
                                <tr>
                                    <td>Perbaikan Bangunan Bagi</td>
                                    <td>12 Unit</td>
                                    <td>9 Unit</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 75%;"></div>
                                        </div>
                                        75%
                                    </td>
                                    <td><span class="status-izin">Delay</span></td>
                                </tr>
                                <tr>
                                    <td>Pemeliharaan Pintu Air</td>
                                    <td>45 Unit</td>
                                    <td>42 Unit</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 93%;"></div>
                                        </div>
                                        93%
                                    </td>
                                    <td><span class="status-hadir">Ahead</span></td>
                                </tr>
                                <tr>
                                    <td>Pembersihan Saluran Sekunder</td>
                                    <td>15.2 Km</td>
                                    <td>11.4 Km</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 75%;"></div>
                                        </div>
                                        75%
                                    </td>
                                    <td><span class="status-hadir">On Track</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Kurva S Kinerja Bulanan Section -->
            <div id="kurva" class="content-section">
                <div class="card">
                    <h3>Kurva S Kinerja Bulanan</h3>
                    <div class="chart-container">
                        <canvas id="sCurveChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h3>Analisis Kinerja</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                        <div>
                            <h4>Kinerja Bulan Ini</h4>
                            <ul style="margin-top: 1rem; padding-left: 1.5rem;">
                                <li>Target Bulanan: 100%</li>
                                <li>Realisasi: 92%</li>
                                <li>Deviasi: -8%</li>
                                <li>Trend: Meningkat</li>
                            </ul>
                        </div>
                        <div>
                            <h4>Proyeksi Akhir Bulan</h4>
                            <ul style="margin-top: 1rem; padding-left: 1.5rem;">
                                <li>Estimasi Pencapaian: 98%</li>
                                <li>Waktu Tersisa: 8 hari</li>
                                <li>Kebutuhan Akselerasi: 6%</li>
                                <li>Status: Dapat Tercapai</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Rekomendasi Tindakan</h3>
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-top: 1rem;">
                        <h4 style="color: #e74c3c; margin-bottom: 1rem;">⚠️ Area yang Memerlukan Perhatian:</h4>
                        <ul style="padding-left: 2rem;">
                            <li><strong>Saluran Sekunder Blok C:</strong> Perlu pembersihan segera untuk mencapai target</li>
                            <li><strong>Bangunan Bagi 2:</strong> Maintenance terjadwal dapat memperlambat progres</li>
                            <li><strong>Tim Maintenance:</strong> Perlu penambahan 2 petugas untuk akselerasi</li>
                        </ul>
                    </div>
                    
                    <div style="background: #e8f5e8; padding: 1.5rem; border-radius: 8px; margin-top: 1rem;">
                        <h4 style="color: #27ae60; margin-bottom: 1rem;">✅ Langkah Perbaikan:</h4>
                        <ul style="padding-left: 2rem;">
                            <li>Alokasi tambahan tenaga kerja untuk pembersihan saluran</li>
                            <li>Percepatan jadwal maintenance bangunan bagi</li>
                            <li>Koordinasi dengan petani untuk optimalisasi penggunaan air</li>
                            <li>Monitoring harian untuk memastikan target tercapai</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- External JavaScript Libraries -->
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <!-- Main JavaScript -->
    <script>
        // Global variables
        let map;
        let layerGroups = {};
        let currentActiveLayer = 'all';

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Show default section
            showSection('dashboard');
            
            // Initialize charts when needed
            initializeCharts();
        }

        // Navigation function
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from menu items
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.classList.remove('active');
            });

            // Show target section
            const targetSection = document.getElementById(sectionName);
            if (targetSection) {
                targetSection.classList.add('active');
            }

            // Add active class to corresponding menu item
            const activeMenuItem = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeMenuItem) {
                activeMenuItem.classList.add('active');
            }

            // Initialize section-specific functionality
            if (sectionName === 'peta') {
                setTimeout(() => {
                    initializeMap();
                }, 100);
            }
        }

        // Initialize Leaflet Map
        function initializeMap() {
            if (map) {
                map.remove();
            }

            // Initialize map centered on Malang, East Java
            map = L.map('map').setView([-7.9666, 112.6326], 13);

            // Add OpenStreetMap tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            // Initialize layer groups
            layerGroups = {
                bendung: L.layerGroup(),
                saluran: L.layerGroup(),
                bangunan: L.layerGroup(),
                sawah: L.layerGroup()
            };

            // Add all layer groups to map
            Object.values(layerGroups).forEach(group => {
                group.addTo(map);
            });

            // Add irrigation infrastructure data
            addIrrigationData();
        }

        // Add irrigation infrastructure data to map
        function addIrrigationData() {
            // Bendung Utama
            const bendungIcon = L.divIcon({
                html: '<i class="fas fa-dam" style="color: #2980b9; font-size: 20px;"></i>',
                iconSize: [30, 30],
                className: 'custom-div-icon'
            });

            L.marker([-7.9666, 112.6326], { icon: bendungIcon })
                .bindPopup(`
                    <div class="custom-popup">
                        <h4>Bendung Molek</h4>
                        <p><strong>Jenis:</strong> Bendung Utama</p>
                        <p><strong>Status:</strong> Aktif</p>
                        <p><strong>Kapasitas:</strong> 15 m³/s</p>
                        <p><strong>Kondisi:</strong> Baik</p>
                    </div>
                `)
                .addTo(layerGroups.bendung);

            // Bangunan Bagi
            const bangunanData = [
                { pos: [-7.9656, 112.6336], name: "Bangunan Bagi 1", status: "Aktif" },
                { pos: [-7.9646, 112.6346], name: "Bangunan Bagi 2", status: "Maintenance" },
                { pos: [-7.9636, 112.6356], name: "Bangunan Bagi 3", status: "Aktif" },
                { pos: [-7.9626, 112.6366], name: "Bangunan Bagi 4", status: "Aktif" }
            ];

            const bangunanIcon = L.divIcon({
                html: '<i class="fas fa-building" style="color: #e74c3c; font-size: 16px;"></i>',
                iconSize: [25, 25],
                className: 'custom-div-icon'
            });

            bangunanData.forEach(item => {
                L.marker(item.pos, { icon: bangunanIcon })
                    .bindPopup(`
                        <div class="custom-popup">
                            <h4>${item.name}</h4>
                            <p><strong>Jenis:</strong> Bangunan Bagi</p>
                            <p><strong>Status:</strong> ${item.status}</p>
                            <p><strong>Kondisi:</strong> ${item.status === 'Aktif' ? 'Baik' : 'Maintenance'}</p>
                        </div>
                    `)
                    .addTo(layerGroups.bangunan);
            });

            // Saluran Primer (polyline)
            const saluranPrimer = [
                [-7.9666, 112.6326],
                [-7.9656, 112.6336],
                [-7.9646, 112.6346],
                [-7.9636, 112.6356],
                [-7.9626, 112.6366]
            ];

            L.polyline(saluranPrimer, {
                color: '#3498db',
                weight: 4,
                opacity: 0.8
            }).bindPopup(`
                <div class="custom-popup">
                    <h4>Saluran Primer</h4>
                    <p><strong>Panjang:</strong> 8.5 Km</p>
                    <p><strong>Kondisi:</strong> Baik</p>
                    <p><strong>Debit:</strong> 12 m³/s</p>
                </div>
            `).addTo(layerGroups.saluran);

            // Saluran Sekunder
            const saluranSekunder1 = [
                [-7.9656, 112.6336],
                [-7.9666, 112.6356],
                [-7.9676, 112.6376]
            ];

            const saluranSekunder2 = [
                [-7.9646, 112.6346],
                [-7.9656, 112.6366],
                [-7.9666, 112.6386]
            ];

            L.polyline(saluranSekunder1, {
                color: '#5dade2',
                weight: 3,
                opacity: 0.7
            }).bindPopup(`
                <div class="custom-popup">
                    <h4>Saluran Sekunder A</h4>
                    <p><strong>Panjang:</strong> 3.2 Km</p>
                    <p><strong>Kondisi:</strong> Baik</p>
                </div>
            `).addTo(layerGroups.saluran);

            L.polyline(saluranSekunder2, {
                color: '#5dade2',
                weight: 3,
                opacity: 0.7
            }).bindPopup(`
                <div class="custom-popup">
                    <h4>Saluran Sekunder B</h4>
                    <p><strong>Panjang:</strong> 2.8 Km</p>
                    <p><strong>Kondisi:</strong> Perlu Pembersihan</p>
                </div>
            `).addTo(layerGroups.saluran);

            // Area Sawah (polygon)
            const areaSawah1 = [
                [-7.9676, 112.6376],
                [-7.9686, 112.6376],
                [-7.9686, 112.6396],
                [-7.9676, 112.6396]
            ];

            const areaSawah2 = [
                [-7.9666, 112.6386],
                [-7.9676, 112.6386],
                [-7.9676, 112.6406],
                [-7.9666, 112.6406]
            ];

            L.polygon(areaSawah1, {
                color: '#27ae60',
                fillColor: '#27ae60',
                fillOpacity: 0.3
            }).bindPopup(`
                <div class="custom-popup">
                    <h4>Blok Sawah A</h4>
                    <p><strong>Luas:</strong> 125 Ha</p>
                    <p><strong>Status:</strong> Masa Tanam</p>
                    <p><strong>Jenis Tanaman:</strong> Padi</p>
                </div>
            `).addTo(layerGroups.sawah);

            L.polygon(areaSawah2, {
                color: '#27ae60',
                fillColor: '#27ae60',
                fillOpacity: 0.3
            }).bindPopup(`
                <div class="custom-popup">
                    <h4>Blok Sawah B</h4>
                    <p><strong>Luas:</strong> 98 Ha</p>
                    <p><strong>Status:</strong> Masa Tanam</p>
                    <p><strong>Jenis Tanaman:</strong> Padi</p>
                </div>
            `).addTo(layerGroups.sawah);
        }

        // Toggle map layers
        function toggleLayer(layerType) {
            // Remove active class from all buttons
            document.querySelectorAll('.map-control-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Add active class to clicked button
            event.target.classList.add('active');

            if (layerType === 'all') {
                // Show all layers
                Object.values(layerGroups).forEach
				                Object.values(layerGroups).forEach(group => {
                    map.addLayer(group);
                });
            } else {
                // Hide all layers first
                Object.values(layerGroups).forEach(group => {
                    map.removeLayer(group);
                });
                
                // Show only selected layer
                if (layerGroups[layerType]) {
                    map.addLayer(layerGroups[layerType]);
                }
            }
            
            currentActiveLayer = layerType;
        }

        // Initialize Charts
        function initializeCharts() {
            // Progress Chart
            const progressCtx = document.getElementById('progressChart');
            if (progressCtx) {
                new Chart(progressCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab', 'Min'],
                        datasets: [{
                            label: 'Target Harian (%)',
                            data: [14.3, 14.3, 14.3, 14.3, 14.3, 14.3, 14.3],
                            backgroundColor: 'rgba(52, 152, 219, 0.3)',
                            borderColor: 'rgba(52, 152, 219, 1)',
                            borderWidth: 2
                        }, {
                            label: 'Realisasi (%)',
                            data: [15.2, 13.8, 14.9, 13.5, 15.1, 12.8, 14.2],
                            backgroundColor: 'rgba(39, 174, 96, 0.3)',
                            borderColor: 'rgba(39, 174, 96, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Progres Harian vs Target'
                            },
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 20,
                                title: {
                                    display: true,
                                    text: 'Persentase (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Hari'
                                }
                            }
                        }
                    }
                });
            }

            // S-Curve Chart
            const sCurveCtx = document.getElementById('sCurveChart');
            if (sCurveCtx) {
                new Chart(sCurveCtx, {
                    type: 'line',
                    data: {
                        labels: ['Minggu 1', 'Minggu 2', 'Minggu 3', 'Minggu 4'],
                        datasets: [{
                            label: 'Target Kumulatif (%)',
                            data: [25, 50, 75, 100],
                            borderColor: 'rgba(52, 152, 219, 1)',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Realisasi Kumulatif (%)',
                            data: [28, 48, 69, 92],
                            borderColor: 'rgba(39, 174, 96, 1)',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Proyeksi (%)',
                            data: [null, null, null, 98],
                            borderColor: 'rgba(243, 156, 18, 1)',
                            backgroundColor: 'rgba(243, 156, 18, 0.1)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Kurva S - Kinerja Bulanan'
                            },
                            legend: {
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 110,
                                title: {
                                    display: true,
                                    text: 'Persentase Kumulatif (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Periode'
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }
        }

        // Menu item click handlers
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('menu-item') || e.target.parentElement.classList.contains('menu-item')) {
                const menuItem = e.target.classList.contains('menu-item') ? e.target : e.target.parentElement;
                const section = menuItem.getAttribute('data-section');
                if (section) {
                    showSection(section);
                }
            }
        });

        // Responsive handling
        window.addEventListener('resize', function() {
            if (map) {
                setTimeout(() => {
                    map.invalidateSize();
                }, 100);
            }
        });

        // Utility functions
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        function formatDate(date) {
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                timeZone: 'Asia/Jakarta'
            };
            return new Date(date).toLocaleDateString('id-ID', options);
        }

        // Auto-refresh data every 5 minutes
        setInterval(function() {
            // Update dashboard stats
            updateDashboardStats();
        }, 300000);

        function updateDashboardStats() {
            // Simulate real-time data updates
            const statCards = document.querySelectorAll('.stat-card h4');
            if (statCards.length > 0) {
                // Update attendance percentage (simulate small changes)
                const attendanceCard = statCards[1];
                const currentValue = parseInt(attendanceCard.textContent);
                const newValue = Math.max(80, Math.min(95, currentValue + Math.floor(Math.random() * 3) - 1));
                attendanceCard.textContent = newValue + '%';
            }
        }

        // Print functionality
        function printReport(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html>
                        <head>
                            <title>SKOPI - Laporan ${sectionId}</title>
                            <style>
                                body { font-family: Arial, sans-serif; margin: 20px; }
                                .header { text-align: center; margin-bottom: 30px; }
                                table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                                th { background-color: #f2f2f2; }
                                .no-print { display: none; }
                            </style>
                        </head>
                        <body>
                            <div class="header">
                                <h1>SKOPI - Sistem Kinerja Operasi dan Pemeliharaan Irigasi</h1>
                                <h2>DI. Molek</h2>
                                <p>Tanggal: ${formatDate(new Date())}</p>
                            </div>
                            ${section.innerHTML}
                        </body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.print();
            }
        }

        // Export data functionality
        function exportToCSV(tableId, filename) {
            const table = document.querySelector(`#${tableId} table`);
            if (!table) return;

            let csv = [];
            const rows = table.querySelectorAll('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const row = [];
                const cols = rows[i].querySelectorAll('td, th');
                
                for (let j = 0; j < cols.length; j++) {
                    let data = cols[j].innerText.replace(/(\r\n|\n|\r)/gm, '').replace(/(\s\s)/gm, ' ');
                    data = data.replace(/"/g, '""');
                    row.push('"' + data + '"');
                }
                csv.push(row.join(','));
            }

            const csvFile = new Blob([csv.join('\n')], { type: 'text/csv' });
            const downloadLink = document.createElement('a');
            downloadLink.download = filename || 'data.csv';
            downloadLink.href = window.URL.createObjectURL(csvFile);
            downloadLink.style.display = 'none';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 5px;
                color: white;
                font-weight: bold;
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
            `;
            
            switch(type) {
                case 'success':
                    notification.style.backgroundColor = '#27ae60';
                    break;
                case 'error':
                    notification.style.backgroundColor = '#e74c3c';
                    break;
                case 'warning':
                    notification.style.backgroundColor = '#f39c12';
                    break;
                default:
                    notification.style.backgroundColor = '#3498db';
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Add CSS for notification animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);

        // Initialize tooltips and other UI enhancements
        document.addEventListener('DOMContentLoaded', function() {
            // Add tooltips to buttons
            const buttons = document.querySelectorAll('.map-control-btn');
            buttons.forEach(btn => {
                btn.title = btn.textContent.trim();
            });
            
            // Show welcome notification
            setTimeout(() => {
                showNotification('Selamat datang di SKOPI - DI. Molek', 'success');
            }, 1000);
        });
    </script>
</body>
</html>
